<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-S8PE79TKZ1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-S8PE79TKZ1');
</script>


    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Article - Don's Blog</title>
    <link rel="stylesheet" href="main-styles.css">
    <link rel="stylesheet" href="post-styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Merriweather:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>

    <nav class="main-nav">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <img src="imb-innovation-logo.png" alt="IMB Innovation" class="logo-img">
            </a>
            <button class="nav-toggle" aria-label="Toggle menu">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-links">
                <div class="dropdown">
                    <button class="dropdown-toggle" aria-label="Select FaithBot language">
                        <span class="dropdown-label">FaithBot (English)</span>
                        <span class="dropdown-arrow">▼</span>
                    </button>
                    <div class="dropdown-menu">
                        <a href="index.html">English</a>
                        <a href="index.html">Arabic</a>
                        <a href="index.html">Bengali</a>
                        <a href="index.html">Burmese</a>
                        <a href="index.html">Cantonese</a>
                        <a href="index.html">Hindi</a>
                        <a href="index.html">Hokkien</a>
                        <a href="index.html">Indonesian</a>
                        <a href="index.html">Japanese</a>
                        <a href="index.html">Javanese</a>
                        <a href="index.html">Khmer</a>
                        <a href="index.html">Korean</a>
                        <a href="index.html">Lao</a>
                        <a href="index.html">Malay</a>
                        <a href="index.html">Mandarin (Simplified)</a>
                        <a href="index.html">Mandarin (Traditional)</a>
                        <a href="index.html">Mongolian</a>
                        <a href="index.html">Shona</a>
                        <a href="index.html">Thai</a>
                        <a href="index.html">Vietnamese</a>
                    </div>
                </div>
                <a href="engage-lostness.html" class="nav-link">Engage Lostness</a>
                <a href="biblepics.html" class="nav-link">Bible Pics</a>
                <a href="blog.html" class="nav-link active">Don's Blog</a>
            </div>
        </div>
    </nav>

    <div class="post-container">
        <div class="post-wrapper">
            <a href="blog.html" class="back-link">← Back to All Articles</a>
            <article id="post-content" class="post-article">
                <div class="loading">Loading article...</div>
            </article>
        </div>
    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const articleUrl = urlParams.get('url');

        async function loadArticle() {
            const container = document.getElementById('post-content');

            if (!articleUrl) {
                container.innerHTML = '<div class="error"><p>No article specified. <a href="blog.html">Return to blog</a></p></div>';
                return;
            }

            try {
                const rssUrl = 'https://donbarger.substack.com/feed';
                const apiUrl = `https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(rssUrl)}`;

                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data.status === 'ok' && data.items) {
                    const article = data.items.find(item => (item.link || item.guid) === articleUrl);

                    if (article) {
                        // Get preview content (first ~500 characters)
                        let previewContent = article.content || article.description || '';

                        // Clean HTML for preview
                        const tempDiv = document.createElement('div');
                        tempDiv.innerHTML = previewContent;

                        // Remove unwanted elements
                        tempDiv.querySelectorAll('a[href*="subscribe"], [class*="subscribe"], [class*="paywall"], button').forEach(el => el.remove());

                        // Get first image if available
                        let featuredImage = '';
                        const firstImg = tempDiv.querySelector('img');
                        if (firstImg) {
                            featuredImage = firstImg.src;
                        }

                        // Extract text content for preview
                        let textContent = tempDiv.textContent || '';
                        textContent = textContent.trim().substring(0, 600);

                        // Get first few paragraphs of HTML content
                        const paragraphs = Array.from(tempDiv.querySelectorAll('p')).slice(0, 3);
                        let previewHTML = paragraphs.map(p => p.outerHTML).join('');

                        // Ensure images are responsive
                        const previewDiv = document.createElement('div');
                        previewDiv.innerHTML = previewHTML;
                        previewDiv.querySelectorAll('img').forEach(img => {
                            img.style.maxWidth = '100%';
                            img.style.height = 'auto';
                        });
                        previewHTML = previewDiv.innerHTML;

                        container.innerHTML = `
                            <header class="post-header">
                                ${featuredImage ? `<img src="${featuredImage}" alt="${article.title}" class="featured-image">` : ''}
                                <h1 class="post-title">${article.title}</h1>
                                <p class="post-meta">
                                    <span class="post-date">${new Date(article.pubDate).toLocaleDateString('en-US', {
                                        year: 'numeric',
                                        month: 'long',
                                        day: 'numeric'
                                    })}</span>
                                    <span class="post-author">by Don Barger</span>
                                </p>
                            </header>
                            <div class="post-preview">
                                ${previewHTML || `<p>${textContent}...</p>`}
                            </div>
                            <div class="continue-reading">
                                <div class="fade-overlay"></div>
                                <div class="continue-cta">
                                    <h3>Continue Reading on Substack</h3>
                                    <p>Get the full article with all the details, examples, and insights.</p>
                                    <a href="${articleUrl}" target="_blank" rel="noopener noreferrer" class="read-full-btn">
                                        Click Here
                                    </a>
                                </div>
                            </div>
                            <footer class="post-footer">
                                <div class="newsletter-signup">
                                    <h3>Want articles like this in your inbox?</h3>
                                    <p>Subscribe to get my latest writing on Innovation, AI, Faith, and Coffee.</p>
                                    <a href="https://donbarger.substack.com/subscribe" target="_blank" rel="noopener noreferrer" class="subscribe-btn">
                                        Subscribe to Newsletter
                                    </a>
                                </div>
                            </footer>
                        `;
                    } else {
                        throw new Error('Article not found');
                    }
                } else {
                    throw new Error('Unable to load');
                }
            } catch (error) {
                console.error('Article loading error:', error);
                container.innerHTML = `
                    <div class="error">
                        <h2>Unable to Load Preview</h2>
                        <p>Read this article directly on Substack:</p>
                        <a href="${articleUrl}" target="_blank" rel="noopener noreferrer" class="substack-btn">Read on Substack →</a>
                    </div>
                `;
            }
        }

        loadArticle();
    </script>
    <script>
        // Dropdown functionality
        document.addEventListener('DOMContentLoaded', function() {
            const dropdown = document.querySelector('.dropdown');
            const dropdownToggle = document.querySelector('.dropdown-toggle');

            if (dropdown && dropdownToggle) {
                dropdownToggle.addEventListener('click', function(e) {
                    e.stopPropagation();
                    dropdown.classList.toggle('active');
                });

                document.addEventListener('click', function() {
                    dropdown.classList.remove('active');
                });
            }
        });

        // Mobile menu toggle
        const navToggle = document.querySelector('.nav-toggle');
        const navLinks = document.querySelector('.nav-links');

        navToggle.addEventListener('click', () => {
            navToggle.classList.toggle('active');
            navLinks.classList.toggle('active');
        });

        // Close menu when clicking a link
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', () => {
                navToggle.classList.remove('active');
                navLinks.classList.remove('active');
            });
        });
    </script>
</body>
</html>
